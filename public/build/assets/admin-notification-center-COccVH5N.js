document.addEventListener("alpine:init",()=>{Alpine.data("adminNotificationCenter",()=>({open:!1,unreadCount:0,notifications:[],loading:!1,init(){this.loadNotifications(),setInterval(()=>this.loadNotifications(),3e4)},toggle(){this.open=!this.open,this.open&&this.loadNotifications()},close(){this.open=!1},async loadNotifications(){if(!this.loading){this.loading=!0;try{const t=await fetch("/api/notifications/unread");if(!t.ok)throw new Error("Error al obtener notificaciones");const o=await t.json();this.notifications=o.tickets||[],this.unreadCount=o.count||0}catch(t){console.error("Error loading notifications:",t)}finally{this.loading=!1}}},async markAsRead(t){try{(await fetch(`/api/notifications/${t}/read`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}})).ok&&await this.loadNotifications()}catch(o){console.error("Error marking notification as read:",o)}},async markAllAsRead(){try{(await fetch("/api/notifications/mark-all-read",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}})).ok&&(await this.loadNotifications(),this.showToast("Todas las notificaciones marcadas como leÃ­das"))}catch(t){console.error("Error marking all notifications as read:",t)}},async openTicket(t){await this.markAsRead(t.id),window.location.href=t.url},showToast(t){const o=document.createElement("div");o.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300",o.textContent=t,document.body.appendChild(o),setTimeout(()=>{o.classList.add("opacity-0","translate-x-full"),setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o)},300)},3e3)}}))});
